<html>
    <script>
        // let cartBuah = []
        // let cartHarga = []
        // let cartJumlah = []
        // let cartTotal = []
        // let namaBuah = ['apple','orange','grape']
        // let price = [10000,15000,20000]
        // let stok = [5,7,8]
        let Buah = {
            nama : ['apple','orange','grape'],
            price : [10000,15000,20000],
            stok : [5,7,8]
        }

        let Cart = {
            nama  : [],
            price : [],
            stok : [],
            total : []
        }

        let run = true
        let output =''
        let menuUtama, inputanNama, inputanStok, inputanHarga, inputanJumlah, totalAwal, listBelanja, belanja, saldo, totalAkhir
        function cetakOutput(){
            output=''
            for(let i = 0; i < Buah.nama.length; i++){
                output += `${i+1}. ${Buah.nama[i]}, stok ${Buah.stok[i]}, harga Rp${Buah.price[i]}\n`
            }
            return output
        }

        alert('selamat datang')

        while(run){
            do{
                menuUtama=parseInt(prompt('Pilih menu\n1. Belanja\n2.Tambah Buah\n3.Edit Buah\n4.Tampilkan Buah\n5.Exit'))
                if(!(menuUtama >= 1 && menuUtama <= 5)){
                    alert('input salah')
                }
            }while(!(menuUtama >= 1 && menuUtama <= 5))

            while(menuUtama == 1){
                pilihBuah = parseInt(prompt(cetakOutput()))
                if(pilihBuah > Buah.nama.length){
                    alert('input salah')
                }else{
                    if((pilihBuah >= 1)||(pilihBuah <= Buah.nama.length)){
                        inputanJumlah = parseInt(prompt('berapa banyak '+ Buah.nama[pilihBuah-1] +'?'))
                        if(inputanJumlah > Buah.stok[pilihBuah-1]){
                            alert(`stok ${Buah.nama[pilihBuah-1]} tidak cukup, stok = ${Buah.stok[pilihBuah-1]}`)
                        }else{
                            Cart.nama.push(Buah.nama[pilihBuah-1])
                            Cart.stok.push(inputanJumlah)
                            Cart.price.push(Buah.price[pilihBuah-1])
                            Cart.total.push(Buah.price[pilihBuah-1] * inputanJumlah)
                            Buah.stok[pilihBuah-1] -= inputanJumlah
                            belanja = confirm('Tekan ok untuk Tambah keranjang\nTekan cancel untuk Bayar')
                            if(belanja==true){
                                menuUtama = 1
                            }else{
                                listBelanja = ''
                                for(let j = 0; j < Cart.nama.length; j++){
                                    listBelanja += `${j+1}. ${Cart.nama[j]}, jumlah ${Cart.stok[j]}, harga Rp${Cart.price[j]} = Rp${Cart.total[j]}\n`
                                }
                                totalAkhir = Cart.total.reduce((a, b) => a + b, 0)
                                listBelanja += `Total Bayar = Rp${totalAkhir}`
                                saldo = parseInt(prompt(listBelanja))
                                if(saldo < totalAkhir){
                                    Buah.stok[pilihBuah-1] += inputanJumlah
                                    Cart.nama = []
                                    Cart.stok = []
                                    Cart.price = []
                                    Cart.total = []
                                    alert('Uang anda kurang')
                                }else{
                                    saldo -= totalAkhir
                                    if(saldo > 0){
                                        Cart.nama = []
                                        Cart.stok = []
                                        Cart.price = []
                                        Cart.total = []
                                        alert('kembalian anda Rp'+saldo)
                                        menuUtama = confirm('Mau belanja lagi?')
                                        if(menuUtama == false){
                                            menuUtama = 6
                                        }
                                    }else{
                                        Cart.nama = []
                                        Cart.stok = []
                                        Cart.price = []
                                        Cart.total = []
                                        alert('terimakasih')
                                        menuUtama = confirm('Mau belanja lagi?')
                                        if(menuUtama == false){
                                            menuUtama = 6
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            // menuUtama = confirm('belanja lagi?')

            if(menuUtama == 2){
                inputanNama = prompt('masukkan nama buah')
                inputanNama = inputanNama.toLowerCase()
                Buah.nama.push(inputanNama)
                inputanStok = parseInt(prompt('masukkan stok buah'))
                Buah.stok.push(inputanStok)
                inputanHarga = parseInt(prompt('masukkan harga satuan'))
                Buah.price.push(inputanHarga)  
                alert(cetakOutput())
            }
            else if(menuUtama == 3){
                pilihBuah = parseInt(prompt(cetakOutput()))
                inputanNama = prompt('masukkan nama buah')
                inputanNama = inputanNama.toLowerCase()
                Buah.nama[pilihBuah-1] = inputanNama
                let inputanStok = parseInt(prompt('masukkan stok buah'))
                Buah.stok[pilihBuah-1] = inputanStok
                let inputanHarga = parseInt(prompt('masukkan harga satuan'))
                Buah.price[pilihBuah-1] = inputanHarga 
                alert(cetakOutput())
            }
            else if(menuUtama == 4){
                alert(cetakOutput())
            }
            else if(menuUtama == 5){
                alert('Selamat Tinggal')
                run = false
            }
            else{
                run = true
            }
        }
    </script>
</html>